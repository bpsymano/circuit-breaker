<mule xmlns="http://www.mulesoft.org/schema/mule/core" 
	xmlns:http="http://www.mulesoft.org/schema/mule/http"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:circuit-breaker="http://www.mulesoft.org/schema/mule/circuit-breaker"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xsi:schemaLocation="
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd 
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/circuit-breaker http://www.mulesoft.org/schema/mule/circuit-breaker/current/mule-circuit-breaker.xsd">

	<circuit-breaker:config name="circuit-breaker-configuration"
		tripThreshold="5" 
		tripResetTime="30000" 
		breakerName="test-circuit-breaker-config" />
		
    <http:request-config name="http-request-config"
    		basePath="/test" 
    		responseTimeout="30000"
    		doc:name="HTTP Request Configuration" >
		<http:request-connection host="localhost" port="8082" />
    	</http:request-config>

	<flow name="dumpConfig">
		<circuit-breaker:dump-config config-ref="circuit-breaker-configuration"
			doc:name="Dump Circuit Breaker Config" />
		<logger level="INFO" doc:name="Logger"
			doc:id="9d1ff210-2e5a-4926-9ae3-98a111ca6c11" />
	</flow>

	<flow name="filter">
		<try doc:name="Try" doc:id="1191fd4d-b908-4945-af60-7800ebe60140">
			<circuit-breaker:filter config-ref="circuit-breaker-configuration" doc:name="filter Circuit Breaker" />
        
			<http:request config-ref="http-request-config" path="/test" method="GET" doc:name="HTTP"/>
		
			<error-handler>
				<on-error-continue enableNotifications="false" logException="false" doc:name="On Error Propagate" >
					<logger level="ERROR" doc:name="Logger" message="test::TRY_BLOCK::ErrorHandling::filter exception" />
					<set-payload value="test::TRY_BLOCK::ErrorHandling::filter exception"/>
				</on-error-continue>
			</error-handler>
		</try>
	</flow>


</mule>
